<template>
    <div if:false={screen} class="slds-spinner_container">
        <lightning-spinner variant="brand" alternative-text={labels.spinnerAlternativeText}></lightning-spinner>
    </div>
    <!-- main container for editor -->
    <div if:true={screen} class="slds-grid screen-editor-container">
        <!-- this div is the container for the left panel-->
        <template if:false={orgHasFlowBuilderAutomaticFields}>
            <div class="slds-size_small slds-grow-none slds-shrink-none">
                <builder_platform_interaction-screen-editor-palette
                    screen-field-types={screenFieldTypes}
                    extension-types={extensionTypes}
                    onaddscreenfield={handleAddScreenField}
                ></builder_platform_interaction-screen-editor-palette>
            </div>
        </template>
        <template if:true={orgHasFlowBuilderAutomaticFields}>
            <div class="slds-size_small slds-grow-none slds-shrink-none slds-border_right">
                <lightning-tabset active-tab-value={activeTab}>
                    <lightning-tab value="componentsTab" label={labels.componentsTabLabel} class="slds-p-around_none">
                        <div class="tab-container-components">
                            <builder_platform_interaction-screen-editor-palette
                                screen-field-types={screenFieldTypes}
                                extension-types={extensionTypes}
                                onaddscreenfield={handleAddScreenField}
                            >
                            </builder_platform_interaction-screen-editor-palette>
                            <builder_platform_interaction-button-banner
                                label={labels.appExchangeButtonLabel}
                                link={appExchangeLink}
                            >
                            </builder_platform_interaction-button-banner>
                        </div>
                    </lightning-tab>
                    <lightning-tab value="fieldsTab" label={labels.fieldsTabLabel} class="slds-p-around_none">
                        <div class="slds-scrollable_y tab-container-automaticfields">
                            <builder_platform_interaction-screen-editor-automatic-field-palette
                                onaddautomaticscreenfield={handleAddScreenField}
                            >
                            </builder_platform_interaction-screen-editor-automatic-field-palette>
                        </div>
                    </lightning-tab>
                </lightning-tabset>
            </div>
        </template>

        <!-- this div is the container for the canvas middle panel-->
        <div class="canvas-container slds-grow slds-shrink slds-scrollable_x">
            <builder_platform_interaction-screen-editor-canvas
                class="slds-size_full"
                screen={screen}
                flow-label={flowLabel}
                selected-item-guid={selectedItemGuid}
                onaddscreenfield={handleAddScreenField}
                onaddautomaticscreenfield={handleAddScreenField}
                onscreenelementselected={handleSelectScreenElement}
                onscreenelementmoved={handleMoveScreenElement}
                onscreenelementdeselected={handleDeselectScreenElement}
                onscreenelementdeleted={handleDeleteScreenElement}
            >
            </builder_platform_interaction-screen-editor-canvas>
        </div>

        <!-- this div is the container for the properties right panel-->
        <div class="slds-grow-none slds-shrink-none">
            <builder_platform_interaction-screen-properties-editor-container
                node={selectedNode}
                mode={mode}
                onaddscreenfield={handleAddScreenFieldToContainerFieldWithParentFocus}
                onaddautomaticscreenfield={handleAddScreenFieldToContainerFieldWithParentFocus}
                onscreennodeselected={handleDeselectScreenElement}
                onpropertychanged={handleScreenStateChanged}
                onvalidationrulechanged={handleScreenStateChanged}
                onchoicechanged={handleScreenStateChanged}
                onchoicedeleted={handleScreenStateChanged}
                onchoiceadded={handleScreenStateChanged}
                onchoicedisplaychanged={handleScreenStateChanged}
                onaddcondition={handleScreenStateChanged}
                onscreenelementdeleted={handleDeleteScreenElement}
                onscreenelementselected={handleSelectScreenElement}
                ondeletecondition={handleScreenStateChanged}
                onupdatecondition={handleScreenStateChanged}
                onupdateconditionlogic={handleScreenStateChanged}
                oncolumnwidthchanged={handleColumnWidthChanged}
                onuseadvancedoptionsselectionchanged={handleScreenStateChanged}
                ondynamictypemappingchange={handleScreenStateChanged}
                oninputsonnextnavtoassocscrnchanged={handleScreenStateChanged}
                process-type={processType}
                extension-types={extensionTypes}
            >
            </builder_platform_interaction-screen-properties-editor-container>
        </div>
    </div>
</template>
