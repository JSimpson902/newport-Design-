<template>
    <div if:true={loopElement}>
        <h3 class="slds-m-top_small slds-modal__content slds-m-left_small">{labels.loopDescription}</h3>
        <div class="slds-p-around_small">
            <builder_platform_interaction-label-description
                label={loopElement.label}
                dev-name={loopElement.name}
                description={loopElement.description}
                guid={loopElement.guid}
                onpropertychanged={handleEvent}
                mode={mode}
            >
            </builder_platform_interaction-label-description>
        </div>
        <div class="slds-border_top slds-p-around_small">
            <h3 class="slds-text-heading_small slds-p-bottom_small">{labels.selectCollectionVariableHeader}</h3>
            <div class="slds-size_medium">
                <builder_platform_interaction-ferov-resource-picker
                    class="test-loop-collection"
                    value={collectionVariable}
                    error-message={loopElement.collectionReference.error}
                    row-index={loopElement.collectionReferenceIndex.value}
                    combobox-config={collectionVariableComboboxConfig}
                    property-editor-element-type={loopElement.elementType}
                    element-config={collectionVariableElementConfig}
                    oncomboboxstatechanged={handleCollectionVariablePropertyChanged}
                    onitemselected={handleCollectionVariablePropertyChanged}
                    hide-global-constants
                    hide-system-variables
                    hide-global-variables
                >
                </builder_platform_interaction-ferov-resource-picker>
            </div>
        </div>
        <div class="slds-border_top slds-p-around_small">
            <div class="slds-grid">
                <h3 class="slds-text-heading_small slds-section__title">
                    <span>{labels.evaluateCollectionHeader}</span>
                </h3>
            </div>
            <lightning-radio-group
                label={labels.evaluateCollectionRadioGroupLabel}
                name="iterationOrder"
                value={iterationOrderValue}
                options={iterationOrderOptions}
                onchange={handleLoopIterationOrderChanged}
                required
            >
            </lightning-radio-group>
        </div>
        <div class="slds-border_top slds-grid slds-p-around_small" if:true={isAutomaticOutputNotSupported}>
            <h3 class="slds-text-heading_small slds-section__title">
                <span>{labels.loopVariableHeader}</span>
            </h3>
            <lightning-helptext content={labels.loopVariableHelpText}></lightning-helptext>
        </div>
        <div
            if:false={isAutomaticOutputNotSupported}
            class="slds-scoped-notification slds-media slds-media_center slds-color__background_gray-3 slds-m-left_small slds-m-right_small slds-m-bottom_small"
        >
            <div class="slds-media__figure">
                <lightning-icon icon-name="utility:info" size="small"></lightning-icon>
            </div>
            <div class="slds-media__body">{labels.loopVariableAutomaticMessage}</div>
        </div>
        <div class="slds-size_medium slds-m-bottom_small slds-m-left_small" if:true={isAutomaticOutputNotSupported}>
            <builder_platform_interaction-ferov-resource-picker
                class="test-loop-variable"
                value={loopVariable}
                error-message={loopElement.assignNextValueToReference.error}
                row-index={loopElement.assignNextValueToReferenceIndex.value}
                combobox-config={loopVariableComboboxConfig}
                property-editor-element-type={loopElement.elementType}
                element-config={loopVariableElementConfig}
                oncomboboxstatechanged={handleLoopVariablePropertyChanged}
                onitemselected={handleLoopVariablePropertyChanged}
                hide-global-constants
                hide-system-variables
                hide-global-variables
            >
            </builder_platform_interaction-ferov-resource-picker>
        </div>
    </div>
</template>
