<template>
    <div class="slds-m-bottom_small slds-border_top">
        <h3 class="slds-text-heading_small slds-p-around_small">{sObjectVariablePickerLabel}</h3>
        <div class="slds-p-horizontal_small slds-form-element slds-size_1-of-2 slds-m-bottom_small">
             <builder_platform_interaction-sobject-or-sobject-collection-picker
                    is-collection={state.isCollection}
                    label={labels.variable}
                    placeholder={sObjectVariablePickerPlaceholder}
                    record-entity-name={state.recordEntityName}
                    element-type={elementType}
                    value={state.outputReference}
                    error-message={sobjectVariableErrorMessage}>
            </builder_platform_interaction-sobject-or-sobject-collection-picker>
        </div>
    </div>
    <div class="slds-m-bottom_small slds-border_top" if:true={state.outputReference}>
        <h3 class="slds-text-heading_small slds-p-around_small">{labels.getFields}</h3>        
        <div class="slds-p-horizontal_small slds-form-element slds-size_1-of-2 slds-m-bottom_small">
            <!-- show ID as a disabled input to inform users that they will get it anyway. -->
            <builder_platform_interaction-combobox label={labels.field} menu-data={idMenuData} value={idComboboxValue} disabled>
            </builder_platform_interaction-combobox>
            <!-- Use combobox component to select fields. -->
            <builder_platform_interaction-list items={queriedFields} onaddlistitem={handleAddField} onupdatelistitem={handleUpdateField} ondeletelistitem={handleDeleteField} add-label='Add Field'>
                <div slot="listBody">
                    <template for:each={queriedFields} for:item="queriedField" for:index="fieldIndex">
                    <div class="slds-list__item slds-is-relative" key={queriedField.rowIndex}>
                        <builder_platform_interaction-record-field-picker-row field-index={fieldIndex} record-entity-name={recordEntityName} value={queriedField.field.value} queried-fields={queriedFields} error-message={queriedField.field.error}></builder_platform_interaction-record-field-picker-row>
                    </div>
                    </template>
                </div>
            </builder_platform_interaction-list>
        </div>
    </div>
</template>