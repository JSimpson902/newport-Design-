<template>
    <div class="slds-builder-header flow-builder-header_border_icon">
        <div class="slds-builder-header__item">
            <div class="slds-builder-header__item-label slds-media slds-media_center">
                <lightning-icon
                    variant="inverse"
                    size="x-small"
                    icon-name={iconName}
                    class="slds-media__figure test-flow-utility-icon"
                ></lightning-icon>
                <div class="slds-media__body test-app-name" aria-hidden>
                    {name}
                </div>
            </div>
        </div>
        <h1
            title={flowNameAndVersionTitle}
            class="slds-builder-header__item custom-item-width test-flow-name-version-title"
        >
            <span class="slds-assistive-text">{assistiveName}</span>
            <span class="custom-builder-header__item-label slds-p-left_medium slds-truncate test-flow-name"
                >{currentFlowName}</span
            >
            &nbsp;
            <span class="custom-builder-header__item-label test-flow-version">{flowVersionNumber}</span>
        </h1>
        <lightning-badge if:true={isSystemMode} label={systemModeLabel} title={systemModeLabel} class={badgeClasses}>
        </lightning-badge>
        <div class="slds-builder-header__item slds-builder-header__utilities">
            <div class="slds-builder-header__utilities-item">
                <a href={backUrl} class="slds-builder-header__item-action slds-media slds-media_center test-back-url">
                    <div class="slds-media__figure">
                        <lightning-icon
                            variant="inverse"
                            size="x-small"
                            icon-name="utility:back"
                            class="slds-icon_container slds-icon-utility-back slds-current-color test-back-utility-icon"
                        >
                        </lightning-icon>
                    </div>
                    <div class="slds-media__body test-back-label">
                        {labels.backButtonText}
                    </div>
                </a>
            </div>
            <template if:false={isGuardrailsEnabled}>
                <div class="slds-builder-header__utilities-item">
                    <a
                        href={helpUrl}
                        target="_blank"
                        class="slds-builder-header__item-action slds-media slds-media_center test-help-url"
                        onclick={handleClickHelp}
                    >
                        <div class="slds-media__figure">
                            <lightning-icon
                                variant="inverse"
                                size="x-small"
                                icon-name="utility:help"
                                class="slds-icon_container slds-icon-utility-back slds-current-color test-help-utility-icon"
                            >
                            </lightning-icon>
                        </div>
                        <div class="slds-media__body test-help-label">
                            {labels.helpButtonText}
                        </div>
                    </a>
                </div>
            </template>

            <template if:true={isGuardrailsEnabled}>
                <div class="slds-builder-header__utilities-item">
                    <lightning-button-menu
                        icon-name="utility:help"
                        menu-alignment="right"
                        variant="bare-inverse"
                        class="slds-builder-header__item-action"
                    >
                        <lightning-menu-item
                            href={helpUrl}
                            target="_blank"
                            label={labels.helpText}
                            onclick={handleClickHelp}
                        ></lightning-menu-item>
                        <lightning-menu-item
                            label={labels.keyboardHelpText}
                            onclick={handleClickKeyboardHelp}
                        ></lightning-menu-item>
                        <lightning-menu-item
                            href={trailheadUrl}
                            target="_blank"
                            label={labels.trailheadText}
                            onclick={handleClickTrailhead}
                        ></lightning-menu-item>
                        <lightning-menu-item
                            href={trailblazerCommunityUrl}
                            target="_blank"
                            label={labels.trailblazerCommunityText}
                            onclick={handleClickTrailblazerCommunity}
                        ></lightning-menu-item>

                        <lightning-menu-divider></lightning-menu-divider>

                        <analyzer_framework-help-menu-item
                            type="view"
                            label={labels.viewGuardrailsText}
                            count={guardrailsParams.count}
                            running={guardrailsParams.running}
                            onclick={handleClickViewGuardrails}
                        ></analyzer_framework-help-menu-item>
                        <analyzer_framework-help-menu-item
                            type="mute"
                            label={labels.muteGuardrailsText}
                            unmute-label={labels.unmuteGuardrailsText}
                            running={guardrailsParams.running}
                            onclick={handleClickMuteGuardrails}
                        ></analyzer_framework-help-menu-item>
                    </lightning-button-menu>
                </div>
            </template>
        </div>
    </div>
</template>
