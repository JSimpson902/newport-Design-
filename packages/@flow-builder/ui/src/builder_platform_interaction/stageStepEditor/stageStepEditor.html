<template>
    <div if:true={element}>
        <div class={styleForLabelDescription}>
            <builder_platform_interaction-label-description
                label={element.label}
                dev-name={element.name}
                description={element.description}
                guid={element.guid}
                onpropertychanged={handleLabelDescriptionPropertyChangedEvent}
                mode={mode}
                editor-params={editorParams}
            >
            </builder_platform_interaction-label-description>
        </div>
    </div>

    <lightning-accordion
        allow-multiple-sections-open
        active-section-name={openSections}
        class="slds-has-divider slds-p-top_none"
    >
        <lightning-accordion-section name="startSection" label={labels.startSectionLabel}>
            <lightning-radio-group
                label={labels.startRadioLabel}
                name="stepStart"
                value={selectedEntryCriteria}
                options={stepStartOptions}
                onchange={handleStepStartChanged}
                required
            >
            </lightning-radio-group>

            <div if:true={isStartCriteriaBasedOnStep}>
                <builder_platform_interaction-combobox
                    menu-data={entryConditionsAvailableStepItems}
                    oncomboboxstatechanged={handleEntryCriteriaItemChanged}
                    onitemselected={handleEntryCriteriaItemChanged}
                    label={labels.whenStepIsComplete}
                    value={entryConditionsSelectedItem}
                    placeholder={labels.entryConditionsItemsPlaceholder}
                >
                </builder_platform_interaction-combobox>
            </div>
        </lightning-accordion-section>

        <lightning-accordion-section name="itemImplementationSection" label={labels.implementationSectionLabel}>
            <div class="slds-grid slds-grid_align-center">
                <lightning-spinner
                    if:true={displayActionSpinner}
                    size="medium"
                    variant="brand"
                    class="spinner"
                ></lightning-spinner>

                <builder_platform_interaction-action-selector
                    class="slds-col slds-size_3-of-3"
                    selected-action={selectedAction}
                    error-message={selectedActionError}
                    invocable-actions={availableActions}
                    invocable-actions-fetched={isActionsFetched}
                    selected-category={selectedCategory}
                    selected-filter-by={selectedFilterBy}
                    onvaluechanged={handleActionSelected}
                    oncannotretrieveactions={handleCannotRetrieveActions}
                    flow-process-type={processType}
                    label-override={labels.actionSelectorLabel}
                >
                </builder_platform_interaction-action-selector>
            </div>

            <builder_platform_interaction-parameter-list
                if:true={showParameterList}
                inputs={actionParameterListConfig.inputs}
                outputs={actionParameterListConfig.outputs}
                warnings={actionParameterListConfig.warnings}
                input-header={actionParameterListConfig.inputHeader}
                output-header={actionParameterListConfig.outputHeader}
                element-type={actionElementType}
                sort-inputs={actionParameterListConfig.sortInputs}
                sort-outputs={actionParameterListConfig.sortOutputs}
                empty-inputs-title={actionParameterListConfig.emptyInputsTitle}
                empty-inputs-body={actionParameterListConfig.emptyInputsBody}
                empty-inputs-outputs-title={actionParameterListConfig.emptyInputsOutputsTitle}
                empty-inputs-outputs-body={actionParameterListConfig.emptyInputsOutputsBody}
                store-output-automatically={actionParameterListConfig.storeOutputAutomatically}
                automatic-output-handling-supported={actionParameterListConfig.automaticOutputHandlingSupported}
                element-info={actionElementInfo}
                onupdateparameteritem={handleParameterPropertyChangedEvent}
                ondeleteparameteritem={handleParameterPropertyChangedEvent}
            ></builder_platform_interaction-parameter-list>
        </lightning-accordion-section>

        <lightning-accordion-section name="actorSelectionSection" label={labels.actorSelectionSectionLabel}>
            <div class="slds-grid slds-grid_align-center">
                <builder_platform_interaction-ferov-resource-picker
                    class="slds-col slds-size_3-of-3"
                    combobox-config={actorComboBoxConfig}
                    property-editor-element-type={propertyEditorElementType}
                    element-param={actorElementParam}
                    rules={resourcePickerRules}
                    error-message={actorErrorMessage}
                    row-index={_actorPickerId}
                    oncomboboxstatechanged={handleActorChanged}
                    onitemselected={handleActorChanged}
                    value={actorValue}
                    is-pill-supported
                    hide-global-constants
                ></builder_platform_interaction-ferov-resource-picker>
            </div>
        </lightning-accordion-section>
    </lightning-accordion>
</template>
