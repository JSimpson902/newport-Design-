<template>
    <div class="slds-panel__header" tabindex="-1">
        <h2 class="slds-panel__header-title slds-text-heading_small slds-truncate">{headerTitle}</h2>
    </div>
    <!-- filter gear icon and selected filters text-->
    <div class="slds-border_bottom">
        <div class="slds-m-left_xxx-small slds-m-vertical_small">
            <builder_platform_interaction-debug-panel-filter
                onpanelfilter={handleDropdown}
                selections={selectedOptions}
            >
            </builder_platform_interaction-debug-panel-filter>
        </div>
    </div>
    <!-- popover containing checkboxes for filters -->
    <template if:true={showOptions}>
        <section
            aria-label={filterPopoverAltText}
            aria-describedby="popover-body-id"
            class="slds-popover slds-is-absolute slds-nubbin_top-left slds-m-left_xx-small"
            role="popover"
        >
            <!--- close popover icon -->
            <lightning-button-icon
                icon-name="utility:close"
                onclick={handleDropdown}
                variant="bare"
                alternative-text={filterClosePopoverAltText}
                class="slds-float_right slds-popover__close"
                title={filterClosePopoverAltText}
            >
            </lightning-button-icon>
            <!-- popover body-->
            <div id="popover-body-id" class="slds-popover__body">
                <lightning-checkbox-group options={options} value={checkboxSelections} onchange={handleFilterChange}>
                </lightning-checkbox-group>
            </div>
        </section>
    </template>

    <div class="slds-panel__body slds-scrollable--y">
        <!-- if there's an error, there will be no debugData.debugTraces-->
        <template for:each={debugTraces} for:item="trace">
            <lightning-accordion
                key={trace.id}
                allow-multiple-sections-open
                class="slds-has-divider--bottom slds-p-around_none slds-m-around_none"
                active-section-name={trace.title}
            >
                <lightning-accordion-section
                    data-name={trace.title}
                    key={trace.id}
                    label={trace.title}
                    name={trace.title}
                >
                    <builder_platform_interaction-debug-panel-body
                        lines={trace.lines}
                        error={trace.error}
                        title={trace.title}
                        waitevents={trace.waitevents}
                        resumetime={trace.resumetime}
                        limits={trace.limits}
                        ifblockresume={ifBlockResume}
                        show-gov-lim={showGovLim}
                    ></builder_platform_interaction-debug-panel-body>
                </lightning-accordion-section>
            </lightning-accordion>
        </template>

        <div if:true={hasErrors} class="error">
            <lightning-formatted-rich-text
                value={errorMessage}
                disable-linkify="true"
                class="errorMsg"
            ></lightning-formatted-rich-text>
        </div>
    </div>
</template>
