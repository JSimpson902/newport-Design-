<template>
    <!-- This template is common, used for invocable-action-editor, apex-plugin-editor, subflow-editor -->
    <div class="slds-form slds-form_compound slds-p-around_small">
        <div class="slds-p-top_small">{subtitle}</div>
        <div class="slds-p-top_small">
            <builder_platform_interaction-label-description
                label={labelDescriptionConfig.label}
                dev-name={labelDescriptionConfig.name}
                description={labelDescriptionConfig.description}
                guid={labelDescriptionConfig.guid}
                mode={mode}
            >
            </builder_platform_interaction-label-description>
        </div>
        <lightning-spinner if:true={displaySpinner} size="medium" variant="brand" class="spinner"></lightning-spinner>

        <div if:true={viewableSubflowInfo} class="test-referenced-flow">
            <h1 class="slds-m-vertical_x-small slds-text-heading_small">{labels.referencedFlowHeading}</h1>
            <lightning-card
                class="custom-card-styling"
                title={viewableSubflowInfo.masterLabel}
                icon-name="standard:flow"
            >
                <lightning-button
                    label={labels.openFlowButtonLabel}
                    title={labels.openFlowButtonTitle}
                    icon-name="utility:new_window"
                    icon-position="right"
                    slot="actions"
                    onclick={handleOpenReferencedSubflow}
                >
                </lightning-button>
            </lightning-card>
        </div>

        <div if:true={isSystemMode}>
            <div class="custom-builder-baseCallOutEditor__mode-info slds-grid">
                <lightning-icon
                    icon-name="utility:info"
                    alternative-text="Info"
                    variant="info"
                    size="small"
                    class="slds-button__icon_left"
                ></lightning-icon>
                <h2>{systemModeText}</h2>
            </div>
        </div>
        <div if:true={showTypeMappings} class="inputs">
            <!-- TODO: Move this into its own component -->
            <ul>
                <h3 class="slds-text-heading_small slds-p-bottom_small inputHeader">{labels.dataTypeMappingsHeader}</h3>
                <div class="slds-text-body_small slds-text-color_weak slds-m-bottom_medium">
                    {labels.dataTypeMappingsSectionDescription}
                </div>
                <template for:each={typeMappings} for:item="dataTypeMapping" for:index="index">
                    <li
                        class="slds-p-around_x-small slds-m-bottom_x-small slds-form-element__row"
                        key={dataTypeMapping.rowIndex}
                    >
                        <builder_platform_interaction-entity-resource-picker
                            class="slds-form-element slds-size_1-of-2"
                            value={dataTypeMapping.typeValue.value}
                            row-index={dataTypeMapping.rowIndex}
                            combobox-config={dataTypeMapping.comboboxConfig}
                            onitemselected={handleDataTypeMappingChange}
                            oncomboboxstatechanged={handleDataTypeMappingChange}
                        >
                        </builder_platform_interaction-entity-resource-picker>
                    </li>
                </template>
            </ul>
        </div>
        <div>
            <template if:false={hideParameters}>
                <div if:false={hasConfigurationEditor}>
                    <h3 if:false={emptyInputs} class="slds-text-heading_small slds-p-vertical_small">
                        {parameterListConfig.inputHeader}
                    </h3>
                </div>
                <builder_platform_interaction-parameter-list
                    inputs={parameterListConfig.inputs}
                    outputs={parameterListConfig.outputs}
                    warnings={warnings}
                    input-header={parameterListConfig.inputHeader}
                    output-header={parameterListConfig.outputHeader}
                    element-type={elementType}
                    sort-inputs={parameterListConfig.sortInputs}
                    sort-outputs={parameterListConfig.sortOutputs}
                    empty-inputs-title={parameterListConfig.emptyInputsTitle}
                    empty-inputs-body={parameterListConfig.emptyInputsBody}
                    empty-inputs-outputs-title={parameterListConfig.emptyInputsOutputsTitle}
                    empty-inputs-outputs-body={parameterListConfig.emptyInputsOutputsBody}
                    store-output-automatically={parameterListConfig.storeOutputAutomatically}
                    automatic-output-handling-supported={parameterListConfig.automaticOutputHandlingSupported}
                    configuration-editor={configurationEditor}
                    configuration-editor-input-variables={configurationEditorInputVariables}
                    configuration-editor-all-input-variables={configurationEditorAllInputVariables}
                    element-info={elementInfo}
                    builder-context={builderContext}
                    configuration-editor-type-mappings={configurationEditorTypeMappings}
                    automatic-output-variables={automaticOutputVariables}
                    display-output-params={displayOutputParams}
                >
                </builder_platform_interaction-parameter-list>
            </template>
        </div>
    </div>
</template>
