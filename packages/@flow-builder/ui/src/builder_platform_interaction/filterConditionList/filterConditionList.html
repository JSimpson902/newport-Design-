<template>
    <builder_platform_interaction-condition-list
        parent-guid={elementGuid}
        conditions={conditions}
        condition-logic-options={conditionLogicOptions}
        condition-logic={conditionLogic}
        logic-combobox-label={labels.filterConditionsHeader}
        onpropertychanged={handleConditionLogicChanged}
    >
        <div slot="conditions" if:false={showFormulaEditor}>
            <!-- List of condition expressions -->
            <template for:each={conditionsWithPrefixes} for:item="conditionWithPrefix" for:index="conditionIndex">
                <div class="slds-list__item slds-is-relative" key={conditionWithPrefix.condition.rowIndex}>
                    <builder_platform_interaction-row
                        item-prefix={conditionWithPrefix.prefix}
                        show-prefix={showPrefix}
                        item-index={conditionIndex}
                        show-delete={showDeleteCondition}
                        key={conditionWithPrefix.condition.rowIndex}
                    >
                        <div slot="rowBody">
                            <builder_platform_interaction-field-to-ferov-expression-builder
                                if:true={isSObjectOrApex}
                                object-type={sobjectOrApexReference.value}
                                container-element={elementType}
                                lhs-fields={recordFields}
                                rules={rulesForExpressionBuilder}
                                expression={conditionWithPrefix.condition}
                                lhs-label={labels.lhsLabel}
                                lhs-placeholder={labels.lhsPlaceholder}
                                operator-label={labels.operatorLabel}
                                operator-placeholder={labels.operatorPlaceholder}
                                rhs-label={labels.rhsLabel}
                                rhs-placeholder={labels.rhsPlaceholder}
                            >
                            </builder_platform_interaction-field-to-ferov-expression-builder>
                            <builder_platform_interaction-fer-to-ferov-expression-builder
                                if:false={isSObjectOrApex}
                                container-element={elementType}
                                rules={rulesForExpressionBuilder}
                                lhs-formatted-display-text={conditionWithPrefix.lhsFormattedDisplayText}
                                expression={conditionWithPrefix.condition}
                                lhs-label={labels.lhsLabel}
                                lhs-disabled
                                operator-label={labels.operatorLabel}
                                operator-placeholder={labels.operatorPlaceholder}
                                rhs-label={labels.rhsLabel}
                                rhs-placeholder={labels.rhsPlaceholder}
                            >
                            </builder_platform_interaction-fer-to-ferov-expression-builder>
                        </div>
                    </builder_platform_interaction-row>
                </div>
            </template>
        </div>
    </builder_platform_interaction-condition-list>
    <!-- Use resourced text area for formula v1 -->
    <builder_platform_interaction-resourced-textarea
        if:true={showFormulaEditor}
        label={labels.formulaFieldLabel}
        name={labels.formulaFieldLabel}
        required
        for-formula
        row-index
        value={formula}
        onblur={handleFormulaChanged}
        onchange={handleFormulaChanged}
    >
    </builder_platform_interaction-resourced-textarea>
</template>
